#!/bin/sh

testsFolder=tests

# Clean previous tests if any
./clean

# Generate cases with CaseFOAM
python genCases.py

# Remove some files that are automatically generated by CaseFOAM
# These files are not needed when the tests are executed with pytest & oftest
rm rmCases
rm Allrun
rm Allclean
rm -r $testsFolder/baseCase

# Run the test across multiple CPUs:
# "-n auto" for as many processors as available, else specify a number "-n 16"
# "--no-clean-up" option keeps the cases, check "conftest.py" file for more

pytest --no-clean-up -n auto $testsFolder

# Get and analyse results
python getResults.py
